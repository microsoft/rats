identity:
  secret_storage:
    vault:
      key_vault_name: "platinum-vault"
      resource_group_name: "AnalyticsWorkbenchIACTest"
      tenant_id: "497cd8de-e675-4c7b-aec9-e8f20f8f0026"
    key_rotation:
      subscription_id: "6192729e-e45b-4a39-919b-83d7fa6db718"
      user_group_object_id: "b50d3a6d-b75b-4cab-8534-a23782a43dde"
  default_azure_identity_name: default
  default_azure_cli_identity_name: "azure-cli.adpt"
  # group_object_ids:
  #   readers: ""
  #   contributors: ""
  #   owners: ""
  azure_identities:
  # Default credential used when wanting to authenticate as the local user (us or managed identity)
  - name: "default"
    identity_config:
      identity_type: "local"
  - name: "azure-cli.msft"
    identity_config:
      identity_type: "azure-cli"
      tenant_id: "72f988bf-86f1-41af-91ab-2d7cd011db47"
      subscription_id: "7bd3802d-452e-4b2a-964e-e2c996bc7477"
  - name: "azure-cli.adpt"
    identity_config:
      identity_type: "azure-cli"
      tenant_id: "497cd8de-e675-4c7b-aec9-e8f20f8f0026"
      subscription_id: "2c3047b5-a922-4ad0-9319-851026c53797"
  - name: "azure-cli.adaptiveanalyticsworkbench"
    identity_config:
      identity_type: "azure-cli"
      tenant_id: "497cd8de-e675-4c7b-aec9-e8f20f8f0026"
      subscription_id: "6192729e-e45b-4a39-919b-83d7fa6db718"
  - name: "adpt-dataset-transfer"
    identity_config:
      identity_type: "client-secret"
    # Identity provisioned by the ADPT Cloud IT team
      client_id: "d7954695-a9ad-48f2-b5d5-0ce1fb6e59d8"
      subscription_id: "6192729e-e45b-4a39-919b-83d7fa6db718"
      tenant_id: "497cd8de-e675-4c7b-aec9-e8f20f8f0026"
      key_vault_name: "platinum-vault"
      key_vault_secret: "adpt-export-dataset-transfer-identity-secret"
      key_vault_cli_identity: "azure-cli.adpt"
  - name: "test-portal-reader"
    identity_config:
      identity_type: "client-secret"
      client_id: 383ae2c0-8858-4029-b7f6-d15fc2693db1
      subscription_id: "6192729e-e45b-4a39-919b-83d7fa6db718"
      tenant_id: "497cd8de-e675-4c7b-aec9-e8f20f8f0026"
      key_vault_name: "platinum-vault"
      key_vault_secret: "adpt-portal-job-runner-identity-secret"
      key_vault_cli_identity: "azure-cli.adpt"
  # A service principal given to msft for them to push data into the adpt tenant
  # This identity is not used for any API calls on the adpt habitat
  - name: "adpt-export"
    identity_config:
      identity_type: "client-secret"
      tenant_id: "497cd8de-e675-4c7b-aec9-e8f20f8f0026"
      subscription_id: "6192729e-e45b-4a39-919b-83d7fa6db718"
      client_id: "9aa27dd4-f083-4cd2-b865-6ecf7620ffe6"
      key_vault_name: "platinum-vault"
      # Convention is "{identity-name}-identity-secret"
      key_vault_secret: "adpt-export-identity-secret"
      key_vault_cli_identity: "azure-cli.adpt"
  # A service principal from MSFT exported to ADPT as credentials to access MSFT resources
  - name: "msft.immunodata-adpt-habitat"
    identity_config:
      identity_type: "external-client-secret"
      # Identity provisioned by the MSFT SW team
      # https://ms.portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationMenuBlade/Overview/appId/c89b5a0b-153c-4c79-a9ac-97e442b43aab/isMSAApp/
      client_id: "c89b5a0b-153c-4c79-a9ac-97e442b43aab"
      subscription_id: "7bd3802d-452e-4b2a-964e-e2c996bc7477"
      tenant_id: "72f988bf-86f1-41af-91ab-2d7cd011db47"
      external_key_vault_name: "immunodata-msft-adpt"
      external_key_vault_secret: "immunodata-msft-adpt-secret"
      external_key_vault_identity_name: "azure-cli.msft"
      key_vault_secret: "msft-immunodata-adpt-habitat-identity-secret"
      key_vault_cli_identity: "azure-cli.adpt"
  - name: "jupyter-lab"
    identity_config:
      identity_type: "managed-identity"
      managed_identity_name: "k8s-pods-jupyter-lab"
      resource_group_name: "AnalyticsWorkbenchIACTest"
      subscription_id: "6192729e-e45b-4a39-919b-83d7fa6db718"
      kubernetes_binding:
        azure_identity_crd_name: "jupyter-lab"
        kubernetes_namespace: "jupyter"
  - name: "jupyter-kernel"
    identity_config:
      identity_type: "managed-identity"
      managed_identity_name: "k8s-pods-jupyter-kernel"
      resource_group_name: "AnalyticsWorkbenchIACTest"
      subscription_id: "6192729e-e45b-4a39-919b-83d7fa6db718"
      kubernetes_binding:
        azure_identity_crd_name: "jupyter-kernel"
        kubernetes_namespace: "jupyter-kernels"
  - name: "workflows"
    identity_config:
      identity_type: "managed-identity"
      managed_identity_name: "k8s-pods-workflows"
      resource_group_name: "AnalyticsWorkbenchIACTest"
      subscription_id: "6192729e-e45b-4a39-919b-83d7fa6db718"
      kubernetes_binding:
        azure_identity_crd_name: "workflow"
        kubernetes_namespace: "workflows"
  - name: "development-workflows"
    identity_config:
      identity_type: "managed-identity"
      managed_identity_name: "k8s-pods-development-workflows"
      resource_group_name: "AnalyticsWorkbenchIACTest"
      subscription_id: "6192729e-e45b-4a39-919b-83d7fa6db718"
      kubernetes_binding:
        azure_identity_crd_name: "development-workflow"
        kubernetes_namespace: "development-workflows"
  - name: "tekton-pipeline"
    identity_config:
      identity_type: "managed-identity"
      managed_identity_name: "k8s-pods-tekton-pipeline"
      resource_group_name: "AnalyticsWorkbenchIACTest"
      subscription_id: "6192729e-e45b-4a39-919b-83d7fa6db718"
      kubernetes_binding:
        azure_identity_crd_name: "tekton-pipeline"
        kubernetes_namespace: "ci-builds"
  resource_tags:
    azure-native:
      ApplicationName: "Habitats"
      BusinessUnit: "Research Data Platform"
      CostCenter: "US065"
      Env: "production"
      Owner: "esilgard@adaptivebiotech.com"
      RG: "AnalyticsWorkbenchIACTest"
      Segment: "untagged"
kubernetes:
  infrastructure:
    allow_k8s_deletion: false
    resource_tags:
      azure-native:
        ApplicationName: "Habitats"
        BusinessUnit: "Research Data Platform"
        CostCenter: "US065"
        Env: "production"
        Owner: "esilgard@adaptivebiotech.com"
        RG: "AnalyticsWorkbenchIACTest"
        Segment: "untagged"
    cluster_name: "platinum"
    location: "westus2"
    kubernetes_version: "1.26.3"
    resource_group_name: "AnalyticsWorkbenchIACTest"
    subscription_id: "6192729e-e45b-4a39-919b-83d7fa6db718"
    tenant_id: "497cd8de-e675-4c7b-aec9-e8f20f8f0026"
    agent_pool_profiles:
      - name: "cicd1a"
        count: 0
        min_count: 0
        max_count: 5
        enable_auto_scaling: true
        max_pods: 30
        mode: "User"
        os_disk_size_gb: 1023
        vm_size: "Standard_E64s_v3"
        node_labels:
          purpose: "cicd"
        node_taints:
          - "dedicated=cicd:NoSchedule"
      - name: "common1a"
        count: 0
        enable_auto_scaling: true
        min_count: 0
        max_count: 3
        max_pods: 30
        mode: "User"
        os_disk_size_gb: 1023
        vm_size: "Standard_D8_v4"
        node_labels:
          purpose: "common"
      - name: "jupyter1a"
        count: 0
        enable_auto_scaling: true
        min_count: 0
        max_count: 5
        max_pods: 30
        mode: "User"
        os_disk_size_gb: 2048
        vm_size: "Standard_F72s_v2"
        node_labels:
          purpose: "jupyter-core"
      - name: "kernels1a"
        count: 0
        enable_auto_scaling: true
        min_count: 0
        max_count: 10
        max_pods: 30
        mode: "User"
        os_disk_size_gb: 1023
        vm_size: "Standard_E64s_v4"
        node_labels:
          purpose: "jupyter-kernels"
      - name: "kernels2a"
        count: 0
        enable_auto_scaling: true
        min_count: 0
        max_count: 1
        max_pods: 30
        mode: "User"
        os_disk_size_gb: 1023
        vm_size: "Standard_L80s_v3"
        node_labels:
          purpose: "jupyter-kernels"
        node_taints:
          - "dedicated=jupyterKernelsStorageOptimized:NoSchedule"
      - name: "workflows1a"
        count: 0
        enable_auto_scaling: true
        min_count: 0
        max_count: 5
        max_pods: 30
        mode: "User"
        os_disk_size_gb: 1023
        vm_size: "Standard_E64s_v4"
        node_labels:
          purpose: "workflows"
      - name: "system1a"
        count: 2
        enable_auto_scaling: true
        min_count: 2
        max_count: 5
        max_pods: 30
        mode: "System"
        os_disk_size_gb: 1023
        vm_size: "Standard_D4_v4"
        node_taints:
          - "CriticalAddonsOnly=true:NoSchedule"
    log_analytics:
      workspace_name: "platinum-log"
      retention_in_days: 30
    network:
      service_cidr: "10.11.0.0/16"
      dns_service_ip: "10.11.0.10"
      docker_bridge_cidr: "10.12.0.1/16"
    public_ip:
      name: "platinum-public-ip"
    dns_prefix: "platinum-dns"
    vnet:
      name: "platinum-vnet"
      address_prefix: "10.10.0.0/16"
      subnet:
        - name: "platinum-subnet"
          address_prefix: "10.10.128.0/17"
storage:
  default_subscription_id: "6192729e-e45b-4a39-919b-83d7fa6db718"
  default_resource_group_name: "AnalyticsWorkbenchIACTest"
  default_owner_user_group_id: "b50d3a6d-b75b-4cab-8534-a23782a43dde"
  accounts:
  - name: "adptinternalinfra"
    account_type: "external"
    cli_identity_name: "azure-cli.adaptiveanalyticsworkbench"
    storage_account_name: "adptinternalinfra"
    resource_group_name: "InternalHabitatMGMT"
    containers:
    - "pulumi"
    tags:
      - "infrastructure"
  - name: "adptplatinummetadata"
    account_type: "managed"
    cli_identity_name: "azure-cli.adpt"
    storage_account_name: "adptplatinummetadata"
    containers:
      - name: "production"
        tags:
          - "production"
      - name: "development"
        tags:
          - "development"
    tags:
      - "metadata"
  - name: "adptjupyterscratch01"
    account_type: "managed"
    storage_account_name: "adptjupyterscratch01"
    containers:
      - "adptjupyterscratch01"
    tags:
      - "scratch"
  - name: "adptplatinumfiles"
    account_type: "managed"
    storage_account_name: "adptplatinumfiles"
    containers:
      - "general"
      - "sideloaded"
      - "immunodata-annotations-raw-batches"
    tags:
      - "production"
      - "datasets"
  - name: "adptplatinumfilesdev01"
    account_type: "managed"
    storage_account_name: "adptplatinumfilesdev01"
    containers:
      - "general"
      - "tmp"
      - "sideloaded"
      - "immunodata-annotations-raw-batches"
    tags:
      - "development"
      - "datasets"
  - name: "adptjupyternotebooks01"
    account_type: "managed"
    storage_account_name: "adptjupyternotebooks01"
    shares:
      - "jupyter-notebooks"
    tags:
      - "notebooks"
  - name: "datasetmetadata"
    account_type: "external"
    storage_account_name: "datasetmetadata"
    identity_name: "msft.immunodata-adpt-habitat"
    tags:
      - "metadata"
  - name: "ampdatasets01"
    account_type: "external"
    storage_account_name: "ampdatasets01"
    identity_name: "msft.immunodata-adpt-habitat"
    tags:
      - "production"
      - "datasets"
  - name: "ampdata02"
    account_type: "external"
    storage_account_name: "ampdata02"
    identity_name: "msft.immunodata-adpt-habitat"
    tags:
      - "production"
      - "datasets"
  - name: "ampdatasetsdev01"
    account_type: "external"
    storage_account_name: "ampdatasetsdev01"
    identity_name: "msft.immunodata-adpt-habitat"
    tags:
      - "development"
      - "datasets"
  - name: "jupyterscratch01"
    account_type: "external"
    storage_account_name: "jupyterscratch01"
    identity_name: "msft.immunodata-adpt-habitat"
    tags:
      - "scratch"
  - name: "adptdatasethandoffs"
    account_type: "external"
    storage_account_name: "adptdatasethandoffs"
    identity_name: "adpt-dataset-transfer"
  - name: "adptanalyticsworkbench"
    account_type: "external"
    storage_account_name: "adptanalyticsworkbench"
    identity_name: "adpt-export"
  - name: "adaptiveruopipelinetest"
    account_type: "external"
    storage_account_name: "adaptiveruopipelinetest"
    identity_name: "test-portal-reader"
  resource_tags:
    azure-native:
      ApplicationName: "Habitats"
      BusinessUnit: "Research Data Platform"
      CostCenter: "US065"
      Env: "production"
      Owner: "esilgard@adaptivebiotech.com"
      RG: "AnalyticsWorkbenchIACTest"
      Segment: "untagged"
